(this["webpackJsonpreact_todo-app"]=this["webpackJsonpreact_todo-app"]||[]).push([[0],{17:function(e,t,c){},18:function(e,t,c){},19:function(e,t,c){},21:function(e,t,c){},23:function(e,t,c){"use strict";c.r(t);var n,a=c(12),r=c.n(a),o=c(7),s=(c(17),c(18),c(19),c(9)),u=c(3),i=c(0),l=c.n(i),j=c(8),b=c.n(j),d=c(6),h=c(5),f=c.n(h),p="https://mate.academy/students-api/users",O=2451,m=function(){var e=Object(d.a)(f.a.mark((function e(t){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"/").concat(t));case 2:return c=e.sent,e.abrupt("return",c.ok?c.json():null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x="https://mate.academy/students-api/todos",v=function(){var e=Object(d.a)(f.a.mark((function e(t){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x,"?userId=").concat(t));case 2:if((c=e.sent).ok){e.next=5;break}throw new Error("".concat(c.status));case 5:return e.abrupt("return",c.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(d.a)(f.a.mark((function e(t){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x),{headers:{"Content-type":"application/json; charset=UTF-8"},method:"POST",body:JSON.stringify(t)});case 2:if((c=e.sent).ok){e.next=5;break}throw new Error("".concat(c.status));case 5:return e.abrupt("return",c.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(d.a)(f.a.mark((function e(t,c){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x,"/").concat(t),{headers:{"Content-type":"application/json; charset=UTF-8"},method:"PATCH",body:JSON.stringify(c)});case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("".concat(n.status));case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)})));return function(t,c){return e.apply(this,arguments)}}(),y=function(){var e=Object(d.a)(f.a.mark((function e(t){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x,"/").concat(t),{method:"DELETE"});case 2:if((c=e.sent).ok){e.next=5;break}throw new Error("".concat(c.status));case 5:return e.abrupt("return",c.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();!function(e){e.All="all",e.Active="active",e.Completed="completed"}(n||(n={}));var C=c(2),w=(c(21),c(1)),N=function(e){var t=e.message;return Object(w.jsx)("p",{className:"Error",children:"".concat(t)})},E=l.a.memo((function(e){var t=e.todo,c=e.setTodos,n=Object(i.useState)(!1),a=Object(u.a)(n,2),r=a[0],o=a[1],s=Object(i.useState)(!1),l=Object(u.a)(s,2),j=l[0],d=l[1],h=Object(i.useState)(t.title),f=Object(u.a)(h,2),p=f[0],m=f[1],x=Object(i.useRef)(document.createElement("input")),k=Object(i.useCallback)((function(){o(!0),setTimeout((function(){return o(!1)}),1500)}),[]),C=Object(i.useCallback)((function(){g(t.id,{completed:!t.completed}).then((function(){return v(O)})).then(c).catch(k)}),[t]),E=Object(i.useCallback)((function(){y(t.id).then((function(){return v(O)})).then(c).catch((function(){o(!0),setTimeout((function(){return o(!1)}),1e3)}))}),[t]),T=Object(i.useCallback)((function(){d(!0)}),[]),S=Object(i.useCallback)((function(){p?(d(!1),g(t.id,{title:p}).then((function(){return v(O)})).then(c).catch((function(){m(t.title),k()}))):y(t.id).then((function(){return v(O)})).then(c).catch((function(){m(t.title),k()}))}),[p]),A=Object(i.useCallback)((function(e){switch(e.key){case"Enter":S();break;case"Escape":d(!1),m(t.title)}}),[t]);return Object(i.useEffect)((function(){j&&x.current.focus()}),[j]),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("li",{className:b()({completed:t.completed},{editing:j}),children:[Object(w.jsxs)("div",{className:"view",children:[Object(w.jsx)("input",{type:"checkbox",className:"toggle",checked:t.completed,onChange:C}),Object(w.jsx)("label",{onDoubleClick:T,children:t.title}),Object(w.jsx)("button",{type:"button",className:"destroy",onClick:E})]}),Object(w.jsx)("input",{type:"text",className:"edit",ref:x,value:p,onChange:function(e){return m(e.target.value)},onBlur:S,onKeyDown:A})]},t.id),r&&Object(w.jsx)(N,{message:"Server error: try again later"})]})})),T=function(e){var t=e.todos,c=e.setTodos;return Object(w.jsx)("ul",{className:"todo-list",children:t.map((function(e){return Object(w.jsx)(E,{todo:e,setTodos:c},e.id)}))})},S=l.a.memo((function(e){var t=e.todos,c=e.setTodos;return Object(w.jsxs)(C.d,{children:[Object(w.jsx)(C.b,{path:"/",element:Object(w.jsx)(T,{todos:t,setTodos:c})}),Object(w.jsx)(C.b,{path:n.All,element:Object(w.jsx)(C.a,{to:"/"})}),Object(w.jsx)(C.b,{path:n.Active,element:Object(w.jsx)(T,{todos:t.filter((function(e){return!e.completed})),setTodos:c})}),Object(w.jsx)(C.b,{path:n.Completed,element:Object(w.jsx)(T,{todos:t.filter((function(e){return e.completed})),setTodos:c})}),Object(w.jsx)(C.b,{path:"*",element:Object(w.jsx)(C.a,{to:"/"})})]})})),A=function(){var e=Object(i.useState)(!0),t=Object(u.a)(e,2),c=t[0],a=t[1],r=Object(i.useState)(!1),l=Object(u.a)(r,2),j=l[0],d=l[1],h=Object(i.useState)(null),f=Object(u.a)(h,2),p=f[0],x=f[1],C=Object(i.useState)([]),E=Object(u.a)(C,2),T=E[0],A=E[1],F=Object(i.useState)(""),D=Object(u.a)(F,2),J=D[0],I=D[1],M=Object(i.useMemo)((function(){return T.filter((function(e){return!e.completed}))}),[T]),B=Object(i.useMemo)((function(){return c?"Loading...":"Server error: couldn't load user"}),[c]),L=Object(i.useCallback)((function(){d(!0),setTimeout((function(){return d(!1)}),1500)}),[]);Object(i.useEffect)((function(){v(O).then(A).catch(L),m(O).then((function(e){x(e),a(!1)}))}),[]);var P=Object(i.useCallback)((function(e){e.preventDefault(),k({userId:O,title:J,completed:!1}).then((function(){I(""),v(O).then(A)})).catch(L)}),[J]),U=Object(i.useCallback)((function(){var e=[];0===M.length||M.length===T.length?T.forEach((function(t){e.push(Object(s.a)(Object(s.a)({},t),{},{completed:!t.completed})),g(t.id,{completed:!t.completed}).catch(L)})):T.forEach((function(t){t.completed?e.push(t):(e.push(Object(s.a)(Object(s.a)({},t),{},{completed:!0})),g(t.id,{completed:!0}).catch(L))})),A(e)}),[T,M]),_=Object(i.useCallback)((function(){var e=[];T.forEach((function(t){t.completed?y(t.id).catch(L):e.push(t)})),A(e)}),[T]);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("section",{className:"todoapp",children:[Object(w.jsxs)("header",{className:"header",children:[Object(w.jsx)("h1",{children:p?"".concat(p.name," todos"):B}),Object(w.jsx)("form",{onSubmit:P,children:Object(w.jsx)("input",{type:"text",className:"new-todo",placeholder:"What needs to be done?",value:J,onChange:function(e){j&&d(!1),I(e.target.value)}})})]}),Object(w.jsxs)("section",{className:"main",children:[Object(w.jsx)("input",{type:"checkbox",id:"toggle-all",className:"toggle-all",onChange:U}),Object(w.jsx)("label",{htmlFor:"toggle-all",children:"Mark all as complete"}),T.length>0&&Object(w.jsx)(S,{todos:T,setTodos:A})]}),T.length>0&&Object(w.jsxs)("footer",{className:"footer",children:[Object(w.jsx)("span",{className:"todo-count",children:"".concat(M.length," items left")}),Object(w.jsxs)("ul",{className:"filters",children:[Object(w.jsx)("li",{children:Object(w.jsx)(o.b,{to:"/",className:function(e){var t=e.isActive;return b()({selected:t})},children:"All"})}),Object(w.jsx)("li",{children:Object(w.jsx)(o.b,{to:"/".concat(n.Active),className:function(e){var t=e.isActive;return b()({selected:t})},children:"Active"})}),Object(w.jsx)("li",{children:Object(w.jsx)(o.b,{to:"/".concat(n.Completed),className:function(e){var t=e.isActive;return b()({selected:t})},children:"Completed"})})]}),M.length!==T.length&&Object(w.jsx)("button",{type:"button",className:"clear-completed",onClick:_,children:"Clear completed"})]})]}),j&&Object(w.jsx)(N,{message:"Server error: try again later"})]})};r.a.render(Object(w.jsx)(o.a,{children:Object(w.jsx)(A,{})}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.86a708a4.chunk.js.map